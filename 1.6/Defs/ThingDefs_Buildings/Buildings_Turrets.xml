<?xml version="1.0" encoding="utf-8" ?>
<Defs>

  <!-- Catapult -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Turret_Catapult</defName>
    <label>catapult</label>
    <description>A ballistic device used to launch a projectile a great distance without the aid of gunpowder or other propellants. In use since ancient times, the catapult has proven to be one of the most persistently effective mechanisms in warfare.</description>
    <thingClass>Building_TurretGun</thingClass>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <hasInteractionCell>True</hasInteractionCell>
    <interactionCellOffset>(0,0,-2)</interactionCellOffset>
    <stealable>false</stealable>
    <tickerType>Normal</tickerType>
    <graphicData>
      <graphicClass>Graphic_Single</graphicClass>
      <texPath>NewThings/Security/TurretCatapult/TurretCatapult_Base</texPath>
      <drawSize>(3.1,3.1)</drawSize>
      <damageData>
        <rect>(0.38,0.2,0.56375,0.8)</rect>
        <cornerTL>Damage/Corner</cornerTL>
      </damageData>
      <shadowData>
        <offset>(-0.13,-0.87,-0.1)</offset>
        <volume>(0.5,0.4,1.05)</volume>
      </shadowData>
    </graphicData>
    <techLevel>Medieval</techLevel>
    <altitudeLayer>Building</altitudeLayer>
    <uiIconPath>NewThings/Security/TurretCatapult/TurretCatapult_MenuIcon</uiIconPath>
    <uiIconScale>0.85</uiIconScale>
    <size>(3,3)</size>
    <rotatable>true</rotatable>
    <blockWind>true</blockWind>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.4</fillPercent>
    <stuffCategories>
      <li>Stony</li>
      <li>Woody</li>
    </stuffCategories>
    <costStuffCount>150</costStuffCount>
    <costList>
      <Steel>50</Steel>
      <WoodLog>140</WoodLog>
    </costList>
    <terrainAffordanceNeeded>Heavy</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <constructionSkillPrerequisite>6</constructionSkillPrerequisite>
    <inspectorTabs>
      <li>ITab_Shells</li>
    </inspectorTabs>
    <comps>
      <li Class="CompProperties_Forbiddable" />
      <li Class="CompProperties_Mannable">
        <manWorkType>Violent</manWorkType>
        <planetLayerWhitelist>
          <li>Surface</li>
        </planetLayerWhitelist>
      </li>
    </comps>
    <statBases>
      <MaxHitPoints>400</MaxHitPoints>
      <Flammability>0.6</Flammability>
      <WorkToBuild>5500</WorkToBuild>
      <Mass>25</Mass>
      <Beauty>-40</Beauty>
    </statBases>
    <building>
      <turretBurstWarmupTime>5.33</turretBurstWarmupTime>
      <turretBurstCooldownTime>15.33</turretBurstCooldownTime>
      <turretGunDef>VFES_Artillery_Catapult</turretGunDef>
      <turretTopDrawSize>3</turretTopDrawSize>
      <buildingTags>
        <li>Artillery</li>
      </buildingTags>
      <playTargetAcquiredSound>false</playTargetAcquiredSound>
    </building>
    <placeWorkers>
      <li>PlaceWorker_NotUnderRoof</li>
      <li>PlaceWorker_TurretTop</li>
      <li>PlaceWorker_PreventInteractionSpotOverlap</li>
    </placeWorkers>
    <researchPrerequisites>
      <li>VFES_SiegeEquipment</li>
    </researchPrerequisites>
  </ThingDef>

  <ThingDef ParentName="BaseArtilleryWeapon">
    <defName>VFES_Artillery_Catapult</defName>
    <label>catapult</label>
    <description>A ballistic device used to launch a projectile a great distance without the aid of gunpowder or other propellants.</description>
    <recoilPower>3</recoilPower>
    <graphicData>
      <texPath>NewThings/Security/TurretCatapult/TurretCatapult_Top</texPath>
    </graphicData>
    <statBases>
      <AccuracyTouch>0.5</AccuracyTouch>
      <AccuracyShort>0.65</AccuracyShort>
      <AccuracyMedium>0.7</AccuracyMedium>
      <AccuracyLong>0.65</AccuracyLong>
    </statBases>
    <weaponTags>
      <li>ArtilleryMedieval</li>
    </weaponTags>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <forceNormalTimeSpeed>false</forceNormalTimeSpeed>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>VFES_Bullet_Catapult</defaultProjectile>
        <warmupTime>5.33</warmupTime>
        <forcedMissRadius>3.9</forcedMissRadius>
        <requireLineOfSight>false</requireLineOfSight>
        <minRange>14.9</minRange>
        <range>500</range>
        <burstShotCount>1</burstShotCount>
        <soundCast>Bow_Recurve</soundCast>
        <muzzleFlashScale>0</muzzleFlashScale>
        <targetParams>
          <canTargetLocations>true</canTargetLocations>
        </targetParams>
      </li>
    </verbs>
    <comps>
      <li Class="CompProperties_ChangeableProjectile" />
    </comps>
    <building>
      <fixedStorageSettings>
        <filter>
          <categories>
            <li>StoneChunks</li>
          </categories>
        </filter>
      </fixedStorageSettings>
      <defaultStorageSettings>
        <filter>
          <categories>
            <li>StoneChunks</li>
          </categories>
        </filter>
      </defaultStorageSettings>
    </building>
  </ThingDef>

  <ThingDef ParentName="BaseBullet">
    <defName>VFES_Bullet_Catapult</defName>
    <label>massive boulder</label>
    <graphicData>
      <texPath>Things/Projectile/Proj_Boulder</texPath>
      <graphicClass>Graphic_Flicker</graphicClass>
    </graphicData>
    <thingClass>Projectile_Explosive</thingClass>
    <projectile>
      <speed>28</speed>
      <explosionRadius>2.9</explosionRadius>
      <flyOverhead>true</flyOverhead>
      <damageDef>Blunt</damageDef>
      <damageAmountBase>25</damageAmountBase>
      <armorPenetrationBase>0.14</armorPenetrationBase>
      <stoppingPower>1.5</stoppingPower>
      <preExplosionSpawnChance>0.4</preExplosionSpawnChance>
      <preExplosionSpawnThingDef>Filth_RubbleRock</preExplosionSpawnThingDef>
      <soundHitThickRoof>Artillery_HitThickRoof</soundHitThickRoof>
      <soundExplode>VFES_Explosion_Catapult</soundExplode>
      <soundImpactAnticipate>MortarRound_PreImpact</soundImpactAnticipate>
      <soundAmbient>MortarRound_Ambient</soundAmbient>
    </projectile>
  </ThingDef>

  <!-- Ballista -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Turret_Ballista</defName>
    <label>ballista</label>
    <description>An ancient military siege engine in the form of a crossbow mounted on a wooden construct. Bolts fired from this machine explode into splinters on impact. Needs to be manned in order to fire.</description>
    <thingClass>Building_TurretGun</thingClass>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <graphicData>
      <texPath>NewThings/Security/TurretBallista/TurretBallista_Base</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(2, 2)</drawSize>
      <damageData>
        <rect>(0.2,0.2,0.6,0.6)</rect>
      </damageData>
      <shadowData>
        <volume>(1.5,0.35,1.4)</volume>
        <offset>(0,0,-0.05)</offset>
      </shadowData>
    </graphicData>
    <techLevel>Medieval</techLevel>
    <uiIconPath>NewThings/Security/TurretBallista/TurretBallista_MenuIcon</uiIconPath>
    <uiIconScale>0.95</uiIconScale>
    <size>(2,2)</size>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>true</rotatable>
    <blockWind>true</blockWind>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.4</fillPercent>
    <hasTooltip>true</hasTooltip>
    <statBases>
      <Mass>18</Mass>
      <Beauty>-20</Beauty>
      <MaxHitPoints>200</MaxHitPoints>
      <Flammability>0.6</Flammability>
      <WorkToBuild>4600</WorkToBuild>
      <AccuracyTouch>0.5</AccuracyTouch>
      <AccuracyShort>0.65</AccuracyShort>
      <AccuracyMedium>0.7</AccuracyMedium>
      <AccuracyLong>0.65</AccuracyLong>
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Mannable">
        <manWorkType>Violent</manWorkType>
      </li>
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Ballista bolts</fuelLabel>
        <fuelGizmoLabel>Ballista bolts</fuelGizmoLabel>
        <showFuelGizmo>true</showFuelGizmo>
        <fuelFilter>
          <thingDefs>
            <li>WoodLog</li>
          </thingDefs>
        </fuelFilter>
        <fuelCapacity>4</fuelCapacity>
        <autoRefuelPercent>0.5</autoRefuelPercent>
        <minimumFueledThreshold>1</minimumFueledThreshold>
        <fuelMultiplier>0.2</fuelMultiplier> <!-- 5 wood per burst, 20 per full reload -->
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <outOfFuelMessage>Needs ballista bolts</outOfFuelMessage>
        <fuelIconPath>UI/Overlays/FuelBallistaBolt</fuelIconPath>
        <initialFuelPercent>1</initialFuelPercent>
      </li>
    </comps>
    <interactionCellOffset>(0,0,-1)</interactionCellOffset>
    <hasInteractionCell>true</hasInteractionCell>
    <stuffCategories>
      <li>Stony</li>
      <li>Woody</li>
    </stuffCategories>
    <costStuffCount>90</costStuffCount>
    <costList>
      <WoodLog>100</WoodLog>
      <Steel>40</Steel>
    </costList>
    <terrainAffordanceNeeded>Light</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <building>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>VFES_Gun_BallistaTurret</turretGunDef>
      <turretBurstCooldownTime>4.8</turretBurstCooldownTime>
      <turretBurstWarmupTime>1.9</turretBurstWarmupTime>
      <turretTopDrawSize>3</turretTopDrawSize>
      <turretTopOffset>(0, 0.05)</turretTopOffset>
      <playTargetAcquiredSound>false</playTargetAcquiredSound>
    </building>
    <constructionSkillPrerequisite>5</constructionSkillPrerequisite>
    <researchPrerequisites>
      <li>VFES_SiegeEquipment</li>
    </researchPrerequisites>
    <placeWorkers>
      <li>PlaceWorker_ShowTurretRadius</li>
      <li>PlaceWorker_TurretTop</li>
    </placeWorkers>
    <modExtensions>
      <li Class="VEF.Weapons.AutoRefuelMannedTurrets">
        <reloadsMoreThanSingleItem>true</reloadsMoreThanSingleItem>
      </li>
    </modExtensions>
  </ThingDef>

  <ThingDef ParentName="BaseWeaponTurret">
    <defName>VFES_Gun_BallistaTurret</defName>
    <label>ballista</label>
    <description>An ancient military siege engine in a form of a crossbow mounted on a wooden construct.</description>
    <graphicData>
      <texPath>NewThings/Security/TurretBallista/TurretBallista_Top</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <soundInteract>Bow_Large</soundInteract>
    <destroyOnDrop>true</destroyOnDrop>
    <tradeability>None</tradeability>
    <useHitPoints>false</useHitPoints>
    <statBases>
      <AccuracyTouch>0.50</AccuracyTouch>
      <AccuracyShort>0.75</AccuracyShort>
      <AccuracyMedium>0.75</AccuracyMedium>
      <AccuracyLong>0.65</AccuracyLong>
      <RangedWeapon_Cooldown>4.8</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>48</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <weaponTags Inherit="false">
      <li>ArtilleryMedieval</li>
    </weaponTags>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>VFES_Bullet_Ballista</defaultProjectile>
        <forcedMissRadius>0.9</forcedMissRadius>
        <warmupTime>1.9</warmupTime>
        <minRange>4.9</minRange>
        <range>85.5</range>
        <soundCast>VFES_Shot_Ballista</soundCast>
        <muzzleFlashScale>0</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <ThingDef ParentName="BaseBullet">
    <defName>VFES_Bullet_Ballista</defName>
    <label>ballista bolt</label>
    <graphicData>
      <texPath>Things/Projectile/Arrow_Big</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(1.2,1.2)</drawSize>
    </graphicData>
    <thingClass>Projectile_Explosive</thingClass>
    <projectile>
      <flyOverhead>true</flyOverhead>
      <damageDef>RangedStab</damageDef>
      <damageAmountBase>25</damageAmountBase>
      <stoppingPower>1.5</stoppingPower>
      <armorPenetrationBase>0.25</armorPenetrationBase>
      <speed>49</speed>
      <screenShakeFactor>0</screenShakeFactor>
      <soundExplode>BuildingDestroyed_Wood_Big</soundExplode>
      <explosionRadius>1.9</explosionRadius>
    </projectile>
  </ThingDef>

  <!-- Military Turret -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Turret_MilitaryTurret</defName>
    <label>military turret</label>
    <description>A refined turret with military-grade stabilization, targeting routines, and hardened casing. Requires steel to refurbish its barrel after heavy use. May explode when damaged. Its dumb AI brain can't be directly controlled, so beware of friendly fire.</description>
    <thingClass>Building_TurretGun</thingClass>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <graphicData>
      <texPath>NewThings/Security/TurretMedium_Base</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(3,3)</drawSize>
      <damageData>
        <rect>(0.2,0.2,0.6,0.6)</rect>
      </damageData>
      <shadowData>
        <volume>(0.27,0.25,0.27)</volume>
        <offset>(0,0,0)</offset>
      </shadowData>
    </graphicData>
    <techLevel>Industrial</techLevel>
    <uiIconPath>NewThings/Security/MilitaryTurret/MilitaryTurret_MenuIcon</uiIconPath>
    <uiIconScale>0.9</uiIconScale>
    <minifiedDef>MinifiedThing</minifiedDef>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>false</rotatable>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <MaxHitPoints>120</MaxHitPoints>
      <Flammability>0.6</Flammability>
      <WorkToBuild>2400</WorkToBuild>
      <Mass>9.5</Mass>
      <Beauty>-20</Beauty>
      <ShootingAccuracyTurret>0.98</ShootingAccuracyTurret> <!-- like level 14 human shooter -->
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Explosive">
        <wickTicks>240</wickTicks>
        <explosiveRadius>3.9</explosiveRadius>
        <explosiveDamageType>Bomb</explosiveDamageType>
        <chanceNeverExplodeFromDamage>0.5</chanceNeverExplodeFromDamage>
      </li>
      <li Class="CompProperties_Forbiddable" />
      <li Class="CompProperties_Power">
        <compClass>CompPowerTrader</compClass>
        <basePowerConsumption>90</basePowerConsumption>
      </li>
      <li Class="CompProperties_Flickable" />
      <li Class="CompProperties_Breakdownable" />
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Shots until barrel change</fuelLabel>
        <fuelGizmoLabel>Barrel durability</fuelGizmoLabel>
        <outOfFuelMessage>Needs new barrel</outOfFuelMessage>
        <fuelFilter><thingDefs><li>Steel</li></thingDefs></fuelFilter>
        <fuelCapacity>70</fuelCapacity>
        <fuelMultiplier>0.666</fuelMultiplier> <!-- 1.5 steel per burst, 105 per full rearm -->
        <initialFuelPercent>1</initialFuelPercent>
        <autoRefuelPercent>0.5</autoRefuelPercent>
        <showFuelGizmo>true</showFuelGizmo>
        <minimumFueledThreshold>1</minimumFueledThreshold>
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <fuelIconPath>UI/Overlays/Barrel</fuelIconPath>
      </li>
      <li Class="CompProperties_Stunnable">
        <affectedDamageDefs>
          <li>Stun</li>
          <li>EMP</li>
        </affectedDamageDefs>
      </li>
    </comps>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.4</fillPercent>
    <hasTooltip>true</hasTooltip>
    <stuffCategories>
      <li>Metallic</li>
    </stuffCategories>
    <costStuffCount>30</costStuffCount>
    <costList>
      <Steel>90</Steel>
      <ComponentIndustrial>5</ComponentIndustrial>
    </costList>
    <terrainAffordanceNeeded>Light</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <constructionSkillPrerequisite>6</constructionSkillPrerequisite>
    <building>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>VFES_Gun_MilitaryTurret</turretGunDef>
      <turretBurstCooldownTime>4.8</turretBurstCooldownTime>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
      <li>PlaceWorker_ShowTurretRadius</li>
    </placeWorkers>
    <researchPrerequisites>
      <li>GunTurrets</li>
      <li>GasOperation</li>
    </researchPrerequisites>
  </ThingDef>

  <ThingDef ParentName="BaseWeaponTurret">
    <defName>VFES_Gun_MilitaryTurret</defName>
    <label>military turret gun</label>
    <description>A refined automatic gun made to be mounted on a turret.</description>
    <graphicData>
      <texPath>NewThings/Security/MilitaryTurret/MilitaryTurret_Top</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <soundInteract>Interact_Rifle</soundInteract>
    <statBases>
      <AccuracyTouch>0.8</AccuracyTouch>
      <AccuracyShort>0.75</AccuracyShort>
      <AccuracyMedium>0.5</AccuracyMedium>
      <AccuracyLong>0.3</AccuracyLong>
      <RangedWeapon_Cooldown>4.8</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>5</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>Bullet_MiniTurret</defaultProjectile>
        <warmupTime>0</warmupTime>
        <range>33.5</range>
        <ticksBetweenBurstShots>8</ticksBetweenBurstShots>
        <burstShotCount>3</burstShotCount>
        <soundCast>GunShotA</soundCast>
        <soundCastTail>GunTail_Light</soundCastTail>
        <muzzleFlashScale>9</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <!-- Armored Turret -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Turret_ArmoredTurret</defName>
    <label>armored turret</label>
    <description>An armored, portable automatic turret. Requires steel to refurbish its barrel after heavy use. Extra armor plating allows the turret to provide some cover, makes it more resistant to enemy fire and prevents explosion in case of severe damage. Its dumb AI brain can't be directly controlled, so beware of friendly fire.</description>
    <thingClass>Building_TurretGun</thingClass>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <graphicData>
      <texPath>NewThings/Security/TurretMedium_Base</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(3,3)</drawSize>
      <damageData>
        <rect>(0.2,0.2,0.6,0.6)</rect>
      </damageData>
      <shadowData>
        <volume>(0.27,0.25,0.27)</volume>
        <offset>(0,0,0)</offset>
      </shadowData>
    </graphicData>
    <techLevel>Industrial</techLevel>
    <uiIconPath>NewThings/Security/ArmoredTurret/ArmoredTurret_MenuIcon</uiIconPath>
    <uiIconScale>0.9</uiIconScale>
    <minifiedDef>MinifiedThing</minifiedDef>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>false</rotatable>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <MaxHitPoints>250</MaxHitPoints>
      <Flammability>0.7</Flammability>
      <WorkToBuild>2200</WorkToBuild>
      <Mass>12</Mass>
      <Beauty>-20</Beauty>
      <ShootingAccuracyTurret>0.96</ShootingAccuracyTurret> <!-- like level 8 human shooter -->
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Forbiddable" />
      <li Class="CompProperties_Power">
        <compClass>CompPowerTrader</compClass>
        <basePowerConsumption>90</basePowerConsumption>
      </li>
      <li Class="CompProperties_Flickable" />
      <li Class="CompProperties_Breakdownable" />
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Shots until barrel change</fuelLabel>
        <fuelGizmoLabel>Barrel durability</fuelGizmoLabel>
        <outOfFuelMessage>Needs new barrel</outOfFuelMessage>
        <fuelFilter><thingDefs><li>Steel</li></thingDefs></fuelFilter>
        <fuelCapacity>60</fuelCapacity>
        <fuelMultiplier>0.75</fuelMultiplier> <!-- 1.333 steel per burst, 80 per full rearm -->
        <initialFuelPercent>1</initialFuelPercent>
        <autoRefuelPercent>0.5</autoRefuelPercent>
        <showFuelGizmo>true</showFuelGizmo>
        <minimumFueledThreshold>1</minimumFueledThreshold>
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <fuelIconPath>UI/Overlays/Barrel</fuelIconPath>
      </li>
      <li Class="CompProperties_Stunnable">
        <affectedDamageDefs>
          <li>Stun</li>
          <li>EMP</li>
        </affectedDamageDefs>
      </li>
    </comps>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.55</fillPercent>
    <hasTooltip>true</hasTooltip>
    <stuffCategories>
      <li>Metallic</li>
    </stuffCategories>
    <costStuffCount>30</costStuffCount>
    <costList>
      <Steel>120</Steel>
      <ComponentIndustrial>3</ComponentIndustrial>
    </costList>
    <terrainAffordanceNeeded>Light</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <constructionSkillPrerequisite>5</constructionSkillPrerequisite>
    <building>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>VFES_Gun_ArmoredTurret</turretGunDef>
      <turretBurstCooldownTime>4.8</turretBurstCooldownTime>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
      <li>PlaceWorker_ShowTurretRadius</li>
    </placeWorkers>
    <researchPrerequisites>
      <li>GunTurrets</li>
    </researchPrerequisites>
  </ThingDef>

  <ThingDef ParentName="BaseWeaponTurret">
    <defName>VFES_Gun_ArmoredTurret</defName>
    <label>military turret gun</label>
    <description>A refined automatic gun made to be mounted on a turret.</description>
    <graphicData>
      <texPath>NewThings/Security/ArmoredTurret/ArmoredTurret_Top</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <soundInteract>Interact_Rifle</soundInteract>
    <statBases>
      <AccuracyTouch>0.77</AccuracyTouch>
      <AccuracyShort>0.7</AccuracyShort>
      <AccuracyMedium>0.45</AccuracyMedium>
      <AccuracyLong>0.24</AccuracyLong>
      <RangedWeapon_Cooldown>4.8</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>5</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>Bullet_MiniTurret</defaultProjectile>
        <warmupTime>0</warmupTime>
        <range>28.9</range>
        <ticksBetweenBurstShots>8</ticksBetweenBurstShots>
        <burstShotCount>2</burstShotCount>
        <soundCast>GunShotA</soundCast>
        <soundCastTail>GunTail_Light</soundCastTail>
        <muzzleFlashScale>9</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <!-- Searchlight -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Turret_Searchlight</defName>
    <label>searchlight</label>
    <description>An apparatus combining an extremely luminous lamp and a mirrored parabolic reflector, useful for lighting up and dazzling targets.</description>
    <thingClass>Building_TurretGun</thingClass>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <graphicData>
      <texPath>NewThings/Security/TurretMedium_Base</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(3,3)</drawSize>
      <damageData>
        <rect>(0.2,0.2,0.6,0.6)</rect>
      </damageData>
      <shadowData>
        <volume>(0.27,0.25,0.27)</volume>
        <offset>(0,0,0)</offset>
      </shadowData>
    </graphicData>
    <techLevel>Industrial</techLevel>
    <uiIconPath>NewThings/Security/SearchlightTurret/SearchlightTurret_MenuIcon</uiIconPath>
    <uiIconScale>0.90</uiIconScale>
    <minifiedDef>MinifiedThing</minifiedDef>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>false</rotatable>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <MaxHitPoints>120</MaxHitPoints>
      <Flammability>0.6</Flammability>
      <WorkToBuild>1800</WorkToBuild>
      <Mass>8</Mass>
      <Beauty>-20</Beauty>
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Forbiddable" />
      <li Class="CompProperties_Power">
        <compClass>CompPowerTrader</compClass>
        <basePowerConsumption>160</basePowerConsumption>
      </li>
      <li Class="CompProperties_Flickable" />
      <li Class="CompProperties_Breakdownable" />
      <li Class="CompProperties_Glower">
        <glowRadius>3</glowRadius>
        <glowColor>(240,240,228,0)</glowColor>
      </li>
      <li Class="CompProperties_Stunnable">
        <affectedDamageDefs>
          <li>Stun</li>
          <li>EMP</li>
        </affectedDamageDefs>
      </li>
    </comps>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.4</fillPercent>
    <hasTooltip>true</hasTooltip>
    <stuffCategories>
      <li>Metallic</li>
    </stuffCategories>
    <costStuffCount>30</costStuffCount>
    <costList>
      <Steel>50</Steel>
      <ComponentIndustrial>3</ComponentIndustrial>
    </costList>
    <designationCategory>Security</designationCategory>
    <building>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>VFES_Gun_Searchlight</turretGunDef>
      <turretBurstCooldownTime>0.17</turretBurstCooldownTime>
    </building>
<!--    <specialDisplayRadius>24.9</specialDisplayRadius>-->
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
    </placeWorkers>
    <constructionSkillPrerequisite>6</constructionSkillPrerequisite>
    <researchPrerequisites>
      <li>GunTurrets</li>
    </researchPrerequisites>
  </ThingDef>

  <ThingDef ParentName="BaseWeaponTurret">
    <defName>VFES_Gun_Searchlight</defName>
    <label>searchlight</label>
    <description>A searchlight for a turret.</description>
    <graphicData>
      <texPath>NewThings/Security/SearchlightTurret/SearchlightTurret_Top</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <statBases>
      <RangedWeapon_Cooldown>0.17</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>5</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <verbs>
      <li>
        <!-- TODO: Temporary -->
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>VFES_Bullet_FlameTurret</defaultProjectile>
<!--        <verbClass>VFESecurity.Verb_Dazzle</verbClass>-->
        <range>24.9</range>
        <muzzleFlashScale>0</muzzleFlashScale>
<!--        <consumeFuelPerShot>1</consumeFuelPerShot>-->
        <drawAimPie>false</drawAimPie>
      </li>
    </verbs>
<!--    <modExtensions>-->
<!--      <li Class="VFESecurity.ExtendedVerbProperties">-->
<!--        <illuminatedRadius>3.9</illuminatedRadius>-->
<!--        <dazzleDurationTicks>300</dazzleDurationTicks>-->
<!--      </li>-->
<!--    </modExtensions>-->
  </ThingDef>

  <!-- Flame Turret -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Turret_Flame</defName>
    <label>flamer turret</label>
    <description>A portable flamethrower turret, capable of spewing a cone of flame that engulfs enemies and terrain. May explode when damaged. Its dumb AI brain can't be directly controlled, so beware of friendly fire.</description>
    <thingClass>Building_TurretGun</thingClass>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <graphicData>
      <texPath>NewThings/Security/TurretMedium_Base</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(3,3)</drawSize>
      <damageData>
        <rect>(0.2,0.2,0.6,0.6)</rect>
      </damageData>
      <shadowData>
        <volume>(0.27,0.25,0.27)</volume>
        <offset>(0,0,0)</offset>
      </shadowData>
    </graphicData>
    <techLevel>Industrial</techLevel>
    <uiIconPath>NewThings/Security/FlamerTurret/FlamerTurret_MenuIcon</uiIconPath>
    <uiIconScale>0.90</uiIconScale>
    <minifiedDef>MinifiedThing</minifiedDef>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>false</rotatable>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <MaxHitPoints>120</MaxHitPoints>
      <Flammability>0</Flammability>
      <WorkToBuild>2400</WorkToBuild>
      <Mass>10</Mass>
      <Beauty>-20</Beauty>
      <ShootingAccuracyTurret>0.96</ShootingAccuracyTurret> <!-- like level 8 human shooter -->
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Explosive">
        <!-- 1.9 explosive radius when empty; 5.9 when full -->
        <explosiveRadius>1.9</explosiveRadius>
        <explosiveExpandPerFuel>0.2</explosiveExpandPerFuel> <!-- Factoring in square rooting -->
        <explosiveDamageType>Flame</explosiveDamageType>
      </li>
      <li Class="CompProperties_Forbiddable" />
      <li Class="CompProperties_Power">
        <compClass>CompPowerTrader</compClass>
        <basePowerConsumption>90</basePowerConsumption>
      </li>
      <li Class="CompProperties_Flickable" />
      <li Class="CompProperties_Breakdownable" />
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Remaining fuel</fuelLabel>
        <fuelGizmoLabel>Remaining fuel</fuelGizmoLabel>
        <fuelFilter><thingDefs><li>Chemfuel</li></thingDefs></fuelFilter>
        <fuelCapacity>20</fuelCapacity>
        <initialFuelPercent>0</initialFuelPercent>
        <autoRefuelPercent>0.5</autoRefuelPercent>
        <showFuelGizmo>true</showFuelGizmo>
        <minimumFueledThreshold>1</minimumFueledThreshold>
        <fuelMultiplier>0.25</fuelMultiplier> <!-- 4 chemfuel per burst, 80 per full reload -->
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <outOfFuelMessage>Needs chemfuel</outOfFuelMessage>
        <fuelIconPath>Things/Item/Resource/Chemfuel</fuelIconPath>
      </li>
      <li Class="CompProperties_Stunnable">
        <affectedDamageDefs>
          <li>Stun</li>
          <li>EMP</li>
        </affectedDamageDefs>
      </li>
    </comps>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.4</fillPercent>
    <hasTooltip>true</hasTooltip>
    <stuffCategories>
      <li>Metallic</li>
    </stuffCategories>
    <costStuffCount>30</costStuffCount>
    <costList>
      <Steel>90</Steel>
      <ComponentIndustrial>5</ComponentIndustrial>
    </costList>
    <terrainAffordanceNeeded>Light</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <constructionSkillPrerequisite>6</constructionSkillPrerequisite>
    <building>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>VFES_Gun_FlameTurret</turretGunDef>
      <turretBurstCooldownTime>5</turretBurstCooldownTime>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
      <li>PlaceWorker_ShowTurretRadius</li>
    </placeWorkers>
    <researchPrerequisites>
      <li>GunTurrets</li>
      <li>BiofuelRefining</li>
    </researchPrerequisites>
  </ThingDef>

  <ThingDef ParentName="BaseWeaponTurret">
    <defName>VFES_Gun_FlameTurret</defName>
    <label>flame turret gun</label>
    <description>A flamethrower made to be mounted on a turret.</description>
    <graphicData>
      <texPath>NewThings/Security/FlamerTurret/FlamerTurret_Top</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <soundInteract>Interact_Rifle</soundInteract>
    <destroyOnDrop>true</destroyOnDrop>
    <tradeability>None</tradeability>
    <useHitPoints>false</useHitPoints>
    <statBases>
      <RangedWeapon_Cooldown>5</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>5</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <weaponTags Inherit="false">
      <li>TurretGun</li>
    </weaponTags>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>VFES_Bullet_FlameTurret</defaultProjectile>
        <ai_AvoidFriendlyFireRadius>3</ai_AvoidFriendlyFireRadius>
        <warmupTime>0</warmupTime>
        <range>16.9</range>
        <burstShotCount>1</burstShotCount>
        <soundCast>InfernoCannon_Fire</soundCast>
        <soundCastTail>GunTail_Light</soundCastTail>
        <muzzleFlashScale>14</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <VEF.Weapons.ExpandableProjectileDef ParentName="BaseBullet">
    <defName>VFES_Bullet_FlameTurret</defName>
    <label>flamer shot</label>
    <thingClass>VEF.Weapons.FlamethrowProjectile</thingClass>
    <graphicData>
      <texPath>Things/Projectile/Proj_InfernoSpewer</texPath>
      <texPathFadeOut>Things/Projectile/Proj_InfernoSpewerFadeOut</texPathFadeOut>
      <shaderType>MoteGlow</shaderType>
    </graphicData>
    <projectile>
      <damageDef>Flame</damageDef>
      <speed>45</speed>
      <damageAmountBase>12</damageAmountBase>
    </projectile>

    <drawOffscreen>true</drawOffscreen>
    <lifeTimeDuration>50</lifeTimeDuration>
    <widthScaleFactor>0.85</widthScaleFactor>
    <heightScaleFactor>1</heightScaleFactor>
    <startingPositionOffset>(0, 0, -1)</startingPositionOffset>
    <totalSizeScale>1.15</totalSizeScale>
    <tickFrameRate>2</tickFrameRate>
    <finalTickFrameRate>5</finalTickFrameRate>
    <tickDamageRate>20</tickDamageRate>
    <dealsDamageOnce>true</dealsDamageOnce>
    <minDistanceToAffect>2</minDistanceToAffect>
  </VEF.Weapons.ExpandableProjectileDef>

  <!-- Shotgun turret -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Turret_ShotgunTurret</defName>
    <label>shotgun turret</label>
    <description>A compact automatic turret fitted with a semi-automatic shotgun. Requires steel to refurbish its barrel after heavy use. May explode when damaged. Its dumb AI brain can't be directly controlled, so beware of friendly fire.</description>
    <thingClass>Building_TurretGun</thingClass>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <graphicData>
      <texPath>NewThings/Security/TurretMedium_Base</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(3,3)</drawSize>
      <damageData>
        <rect>(0.2,0.2,0.6,0.6)</rect>
      </damageData>
      <shadowData>
        <volume>(0.27,0.25,0.27)</volume>
        <offset>(0,0,0)</offset>
      </shadowData>
    </graphicData>
    <techLevel>Industrial</techLevel>
    <uiIconPath>NewThings/Security/ShotgunTurret/ShotgunTurret_MenuIcon</uiIconPath>
    <uiIconScale>0.9</uiIconScale>
    <minifiedDef>MinifiedThing</minifiedDef>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>false</rotatable>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <MaxHitPoints>120</MaxHitPoints>
      <Flammability>0.6</Flammability>
      <WorkToBuild>2400</WorkToBuild>
      <Mass>9.5</Mass>
      <Beauty>-20</Beauty>
      <ShootingAccuracyTurret>0.96</ShootingAccuracyTurret> <!-- like level 8 human shooter -->
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Explosive">
        <wickTicks>240</wickTicks>
        <explosiveRadius>3.9</explosiveRadius>
        <explosiveDamageType>Bomb</explosiveDamageType>
        <chanceNeverExplodeFromDamage>0.5</chanceNeverExplodeFromDamage>
      </li>
      <li Class="CompProperties_Forbiddable" />
      <li Class="CompProperties_Power">
        <compClass>CompPowerTrader</compClass>
        <basePowerConsumption>100</basePowerConsumption>
      </li>
      <li Class="CompProperties_Flickable" />
      <li Class="CompProperties_Breakdownable" />
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Shots until barrel change</fuelLabel>
        <fuelGizmoLabel>Barrel durability</fuelGizmoLabel>
        <outOfFuelMessage>Needs new barrel</outOfFuelMessage>
        <fuelFilter><thingDefs><li>Steel</li></thingDefs></fuelFilter>
        <fuelCapacity>40</fuelCapacity>
        <initialFuelPercent>1</initialFuelPercent>
        <autoRefuelPercent>0.5</autoRefuelPercent> <!-- 2 steel per burst, 80 per full reload -->
        <showFuelGizmo>true</showFuelGizmo>
        <minimumFueledThreshold>2</minimumFueledThreshold>
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <fuelIconPath>UI/Overlays/Barrel</fuelIconPath>
      </li>
      <li Class="CompProperties_Stunnable">
        <affectedDamageDefs>
          <li>Stun</li>
          <li>EMP</li>
        </affectedDamageDefs>
      </li>
    </comps>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.55</fillPercent>
    <hasTooltip>true</hasTooltip>
    <stuffCategories>
      <li>Metallic</li>
    </stuffCategories>
    <costStuffCount>30</costStuffCount>
    <costList>
      <Steel>90</Steel>
      <ComponentIndustrial>4</ComponentIndustrial>
    </costList>
    <terrainAffordanceNeeded>Light</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <constructionSkillPrerequisite>5</constructionSkillPrerequisite>
    <building>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>VFES_Gun_ShotgunTurret</turretGunDef>
      <turretBurstCooldownTime>3.15</turretBurstCooldownTime>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
      <li>PlaceWorker_ShowTurretRadius</li>
    </placeWorkers>
    <researchPrerequisites>
      <li>GunTurrets</li>
      <li>GasOperation</li>
    </researchPrerequisites>
  </ThingDef>

  <ThingDef ParentName="BaseWeaponTurret">
    <defName>VFES_Gun_ShotgunTurret</defName>
    <label>shotgun turret gun</label>
    <description>An automatic shotgun made to be mounted on a turret.</description>
    <graphicData>
      <texPath>NewThings/Security/ShotgunTurret/ShotgunTurret_Top</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <soundInteract>Interact_Rifle</soundInteract>
    <statBases>
      <AccuracyTouch>0.8</AccuracyTouch>
      <AccuracyShort>0.87</AccuracyShort>
      <AccuracyMedium>0.77</AccuracyMedium>
      <AccuracyLong>0.64</AccuracyLong>
      <RangedWeapon_Cooldown>3.15</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>5</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>Bullet_Shotgun</defaultProjectile>
        <warmupTime>0</warmupTime>
        <range>15.9</range>
        <burstShotCount>1</burstShotCount>
        <soundCast>GunShotA</soundCast>
        <soundCastTail>GunTail_Light</soundCastTail>
        <muzzleFlashScale>9</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <!-- Double Autocannon -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Turret_AutocannonDouble</defName>
    <label>double autocannon turret</label>
    <description>A twin-barreled variant of the autocannon turret. While less accurate and slightly shorter-ranged than its single-barreled cousin, it compensates with a high volume of fire. It cannot fire at close-up targets, and may explode when damaged.</description>
    <thingClass>Building_TurretGun</thingClass>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <graphicData>
      <texPath>NewThings/Security/TurretAutocannon_Base</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(1.5, 1.5)</drawSize>
      <damageData>
        <rect>(0.2,0.2,0.6,0.6)</rect>
      </damageData>
      <shadowData>
        <volume>(1.5,0.35,1.4)</volume>
        <offset>(0,0,-0.05)</offset>
      </shadowData>
    </graphicData>
    <techLevel>Industrial</techLevel>
    <uiIconPath>NewThings/Security/TurretAutocannonDouble/TurretAutocannonDouble_MenuIcon</uiIconPath>
    <uiIconScale>0.95</uiIconScale>
    <minifiedDef>MinifiedThing</minifiedDef>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>false</rotatable>
    <size>(2,2)</size>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <MaxHitPoints>420</MaxHitPoints>
      <Flammability>0.7</Flammability>
      <WorkToBuild>20000</WorkToBuild>
      <Mass>140</Mass>
      <Beauty>-20</Beauty>
      <ShootingAccuracyTurret>0.96</ShootingAccuracyTurret> <!-- like level 8 human shooter -->
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Explosive">
        <explosiveRadius>5.9</explosiveRadius>
        <explosiveDamageType>Bomb</explosiveDamageType>
        <chanceNeverExplodeFromDamage>0.5</chanceNeverExplodeFromDamage>
      </li>
      <li Class="CompProperties_Forbiddable" />
      <li Class="CompProperties_Power">
        <compClass>CompPowerTrader</compClass>
        <basePowerConsumption>180</basePowerConsumption>
      </li>
      <li Class="CompProperties_Flickable" />
      <li Class="CompProperties_Breakdownable" />
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Shots until barrel change</fuelLabel>
        <fuelGizmoLabel>Barrel durability</fuelGizmoLabel>
        <fuelFilter>
          <thingDefs>
            <li>Steel</li>
          </thingDefs>
        </fuelFilter>
        <fuelCapacity>90</fuelCapacity>
        <initialFuelPercent>1</initialFuelPercent>
        <autoRefuelPercent>0.5</autoRefuelPercent>
        <showFuelGizmo>true</showFuelGizmo>
        <minimumFueledThreshold>1</minimumFueledThreshold>
        <fuelMultiplier>0.5</fuelMultiplier> <!-- 2 steel per burst, 160 per full rearm -->
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <outOfFuelMessage>Needs new barrel</outOfFuelMessage>
        <fuelIconPath>UI/Overlays/Barrel</fuelIconPath>
      </li>
      <li Class="CompProperties_Stunnable">
        <affectedDamageDefs>
          <li>Stun</li>
          <li>EMP</li>
        </affectedDamageDefs>
      </li>
    </comps>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.4</fillPercent>
    <hasTooltip>true</hasTooltip>
    <costList>
      <Steel>500</Steel>
      <Plasteel>70</Plasteel>
      <ComponentIndustrial>10</ComponentIndustrial>
    </costList>
    <terrainAffordanceNeeded>Heavy</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <building>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>VFES_TurretDoubleAutocannon_Top</turretGunDef>
      <turretBurstCooldownTime>6</turretBurstCooldownTime>
      <turretTopDrawSize>2.7</turretTopDrawSize>
      <turretTopOffset>(0, 0.05)</turretTopOffset>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
      <li>PlaceWorker_ShowTurretRadius</li>
    </placeWorkers>
    <constructionSkillPrerequisite>7</constructionSkillPrerequisite>
    <researchPrerequisites>
      <li>HeavyTurrets</li>
    </researchPrerequisites>
  </ThingDef>

  <ThingDef ParentName="BaseWeaponTurret">
    <defName>VFES_TurretDoubleAutocannon_Top</defName>
    <label>double autocannon</label>
    <description>A self-loading large-bore double cannon designed to be attached to a turret.</description>
    <graphicData>
      <texPath>NewThings/Security/TurretAutocannonDouble/TurretAutocannonDouble_Top</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <soundInteract>Interact_Rifle</soundInteract>
    <statBases>
      <AccuracyTouch>0.28</AccuracyTouch>
      <AccuracyShort>0.64</AccuracyShort>
      <AccuracyMedium>0.6</AccuracyMedium>
      <AccuracyLong>0.44</AccuracyLong>
      <RangedWeapon_Cooldown>6</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>80</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>Bullet_AutocannonTurret</defaultProjectile>
        <warmupTime>0</warmupTime>
        <minRange>8.9</minRange>
        <range>28</range>
        <ticksBetweenBurstShots>13</ticksBetweenBurstShots>
        <burstShotCount>6</burstShotCount>
        <soundCast>Shot_Autocannon</soundCast>
        <soundCastTail>GunTail_Heavy</soundCastTail>
        <muzzleFlashScale>12</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <!-- HMG complex -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Complex_Hmg</defName>
    <label>HMG complex</label>
    <description>A heavy machine gun mounted on sandbags to grant cover. Needs to be manned in order to fire. Requires steel to refurbish its barrel after heavy use.</description>
    <thingClass>Building_TurretGun</thingClass>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <graphicData>
      <texPath>Things/Building/Linked/Sandbags_Atlas</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <linkType>Basic</linkType>
      <linkFlags>
        <li>Sandbags</li>
      </linkFlags>
    </graphicData>
    <techLevel>Industrial</techLevel>
    <uiIconPath>NewThings/Security/ComplexHMGTurret/ComplexHMGTurret_MenuIcon</uiIconPath>
    <uiIconScale>0.95</uiIconScale>
    <minifiedDef>MinifiedThing</minifiedDef>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>true</rotatable>
    <size>(1,1)</size>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <MaxHitPoints>300</MaxHitPoints>
      <Flammability>0.0</Flammability>
      <WorkToBuild>7500</WorkToBuild>
      <Mass>300</Mass>
      <Beauty>-10</Beauty>
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Forbiddable" />
      <li Class="CompProperties_Mannable">
        <manWorkType>Violent</manWorkType>
        <planetLayerWhitelist>
          <li>Surface</li>
        </planetLayerWhitelist>
      </li>
      <li Class="CompProperties_Breakdownable" />
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Shots until barrel change</fuelLabel>
        <fuelGizmoLabel>Barrel durability</fuelGizmoLabel>
        <fuelFilter>
          <thingDefs>
            <li>Steel</li>
          </thingDefs>
        </fuelFilter>
        <fuelCapacity>160</fuelCapacity>
        <initialFuelPercent>1</initialFuelPercent>
        <autoRefuelPercent>0.5</autoRefuelPercent>
        <showFuelGizmo>true</showFuelGizmo>
        <minimumFueledThreshold>1</minimumFueledThreshold>
        <fuelMultiplier>1</fuelMultiplier>
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <outOfFuelMessage>Needs new barrel</outOfFuelMessage>
        <fuelIconPath>UI/Overlays/Barrel</fuelIconPath>
      </li>
    </comps>
    <interactionCellOffset>(0,0,-1)</interactionCellOffset>
    <hasInteractionCell>true</hasInteractionCell>
    <passability>PassThroughOnly</passability>
    <pathCost>42</pathCost>
    <fillPercent>0.55</fillPercent>
    <hasTooltip>true</hasTooltip>
    <stuffCategories>
      <li>Fabric</li>
      <li>Leathery</li>
    </stuffCategories>
    <colorPerStuff>
      <li>
        <stuff>Cloth</stuff>
        <color>(139,122,87)</color>
      </li>
    </colorPerStuff>
    <costStuffCount>5</costStuffCount>
    <costList>
      <Steel>90</Steel>
      <ComponentIndustrial>6</ComponentIndustrial>
    </costList>
    <terrainAffordanceNeeded>Light</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <building>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>VFES_ComplexHmg_Top</turretGunDef>
      <turretBurstCooldownTime>2</turretBurstCooldownTime>
      <turretTopOffset>(0, 0.05)</turretTopOffset>
      <blueprintGraphicData>
        <texPath>Things/Building/Linked/Sandbags_Blueprint_Atlas</texPath>
      </blueprintGraphicData>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
      <li>PlaceWorker_ShowTurretRadius</li>
    </placeWorkers>
    <constructionSkillPrerequisite>7</constructionSkillPrerequisite>
    <researchPrerequisites>
      <li>VWE_TrenchWarfare</li>
    </researchPrerequisites>
    <modExtensions>
      <li Class="VEF.Weapons.AutoRefuelMannedTurrets">
        <reloadsMoreThanSingleItem>true</reloadsMoreThanSingleItem>
      </li>
    </modExtensions>
  </ThingDef>

  <ThingDef ParentName="BaseWeaponTurret">
    <defName>VFES_ComplexHmg_Top</defName>
    <label>minigun</label>
    <description>A self-loading minigun designed to be attached to a turret.</description>
    <graphicData>
      <texPath>NewThings/Security/ComplexHMGTurret/ComplexHMGTurret_Top</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <soundInteract>Interact_Rifle</soundInteract>
    <statBases>
      <AccuracyTouch>0.32</AccuracyTouch>
      <AccuracyShort>0.42</AccuracyShort>
      <AccuracyMedium>0.4</AccuracyMedium>
      <AccuracyLong>0.28</AccuracyLong>
      <RangedWeapon_Cooldown>2</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>80</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>VFES_Bullet_HMG</defaultProjectile>
        <warmupTime>1.033</warmupTime>
        <range>32.9</range>
        <ticksBetweenBurstShots>8</ticksBetweenBurstShots>
        <burstShotCount>8</burstShotCount>
        <soundCast>VFES_Shot_HMG</soundCast>
        <soundCastTail>GunTail_Medium</soundCastTail>
        <muzzleFlashScale>12</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <ThingDef ParentName="BaseBullet">
    <defName>VFES_Bullet_HMG</defName>
    <label>HMG bullet</label>
    <graphicData>
      <texPath>Things/Projectile/Bullet_Big</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <projectile>
      <damageDef>Bullet</damageDef>
      <damageAmountBase>14</damageAmountBase>
      <armorPenetrationBase>0.22</armorPenetrationBase>
      <stoppingPower>2</stoppingPower>
      <speed>40</speed>
    </projectile>
  </ThingDef>

  <!-- Minigun complex -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Complex_Minigun</defName>
    <label>minigun complex</label>
    <description>A multi-barrel machine gun mounted on sandbags to grant cover and provide stability. Where most self-loading guns are powered by the energy from the gunpowder, the minigun uses an electric motor to rapidly cycle cartridges through the weapon. Needs to be manned in order to fire. Requires steel to refurbish its barrels after heavy use.</description>
    <thingClass>Building_TurretGun</thingClass>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <graphicData>
      <texPath>Things/Building/Linked/Sandbags_Atlas</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <linkType>Basic</linkType>
      <linkFlags>
        <li>Sandbags</li>
      </linkFlags>
    </graphicData>
    <techLevel>Industrial</techLevel>
    <uiIconPath>NewThings/Security/ComplexMinigunTurret/ComplexMinigunTurret_MenuIcon</uiIconPath>
    <uiIconScale>0.95</uiIconScale>
    <minifiedDef>MinifiedThing</minifiedDef>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>true</rotatable>
    <size>(1,1)</size>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <MaxHitPoints>300</MaxHitPoints>
      <Flammability>0.0</Flammability>
      <WorkToBuild>35000</WorkToBuild>
      <Mass>300</Mass>
      <Beauty>-10</Beauty>
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Explosive">
        <explosiveRadius>5.9</explosiveRadius>
        <explosiveDamageType>Bomb</explosiveDamageType>
        <chanceNeverExplodeFromDamage>0.5</chanceNeverExplodeFromDamage>
      </li>
      <li Class="CompProperties_Forbiddable" />
      <li Class="CompProperties_Mannable">
        <manWorkType>Violent</manWorkType>
        <planetLayerWhitelist>
          <li>Surface</li>
        </planetLayerWhitelist>
      </li>
      <li Class="CompProperties_Breakdownable" />
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Shots until barrel change</fuelLabel>
        <fuelGizmoLabel>Barrel durability</fuelGizmoLabel>
        <fuelFilter>
          <thingDefs>
            <li>Steel</li>
          </thingDefs>
        </fuelFilter>
        <fuelCapacity>120</fuelCapacity>
        <initialFuelPercent>1</initialFuelPercent>
        <autoRefuelPercent>0.5</autoRefuelPercent>
        <showFuelGizmo>true</showFuelGizmo>
        <minimumFueledThreshold>1</minimumFueledThreshold> 
        <fuelMultiplier>2</fuelMultiplier> <!-- 0.5 stel per burst, 60 per full reload  -->
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <outOfFuelMessage>Needs new barrel</outOfFuelMessage>
        <fuelIconPath>UI/Overlays/Barrel</fuelIconPath>
      </li>
    </comps>
    <interactionCellOffset>(0,0,-1)</interactionCellOffset>
    <hasInteractionCell>true</hasInteractionCell>
    <passability>PassThroughOnly</passability>
    <pathCost>42</pathCost>
    <fillPercent>0.55</fillPercent>
    <hasTooltip>true</hasTooltip>
    <stuffCategories>
      <li>Fabric</li>
      <li>Leathery</li>
    </stuffCategories>
    <colorPerStuff>
      <li>
        <stuff>Cloth</stuff>
        <color>(139,122,87)</color>
      </li>
    </colorPerStuff>
    <costStuffCount>5</costStuffCount>
    <costList>
      <Steel>140</Steel>
      <ComponentIndustrial>14</ComponentIndustrial>
    </costList>
    <terrainAffordanceNeeded>Light</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <building>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>VFES_ComplexMinigun_Top</turretGunDef>
      <turretBurstCooldownTime>1.5</turretBurstCooldownTime>
      <turretTopOffset>(0, 0.05)</turretTopOffset>
      <blueprintGraphicData>
        <texPath>Things/Building/Linked/Sandbags_Blueprint_Atlas</texPath>
      </blueprintGraphicData>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
      <li>PlaceWorker_ShowTurretRadius</li>
    </placeWorkers>
    <constructionSkillPrerequisite>7</constructionSkillPrerequisite>
    <researchPrerequisites>
      <li>MultibarrelWeapons</li>
    </researchPrerequisites>
    <modExtensions>
      <li Class="VEF.Weapons.AutoRefuelMannedTurrets">
        <reloadsMoreThanSingleItem>true</reloadsMoreThanSingleItem>
      </li>
    </modExtensions>
  </ThingDef>

  <ThingDef ParentName="BaseWeaponTurret">
    <defName>VFES_ComplexMinigun_Top</defName>
    <label>minigun</label>
    <description>A self-loading minigun designed to be attached to a turret.</description>
    <graphicData>
      <texPath>NewThings/Security/ComplexMinigunTurret/ComplexMinigunTurret_Top</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <soundInteract>Interact_Rifle</soundInteract>
    <statBases>
      <AccuracyTouch>0.26</AccuracyTouch>
      <AccuracyShort>0.31</AccuracyShort>
      <AccuracyMedium>0.31</AccuracyMedium>
      <AccuracyLong>0.24</AccuracyLong>
      <RangedWeapon_Cooldown>1.5</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>80</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>Bullet_LMG</defaultProjectile>
        <warmupTime>2.5</warmupTime>
        <range>30.9</range>
        <ticksBetweenBurstShots>5</ticksBetweenBurstShots>
        <burstShotCount>12</burstShotCount>
        <soundCast>Shot_Minigun</soundCast>
        <soundCastTail>GunTail_Medium</soundCastTail>
        <muzzleFlashScale>12</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <!-- Minigun turret -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Turret_Minigun</defName>
    <label>minigun turret</label>
    <description>A heavy automatic turret. Its multi-barrel mechanism unleashes sustained fire at high speed, shredding lightly armored targets at mid-range. It may explode when damaged. Requires steel to refurbish its barrels after heavy use.</description>
    <thingClass>Building_TurretGun</thingClass>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <graphicData>
      <texPath>NewThings/Security/TurretAutocannon_Base</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(1.5, 1.5)</drawSize>
      <damageData>
        <rect>(0.2,0.2,0.6,0.6)</rect>
      </damageData>
      <shadowData>
        <volume>(1.5,0.35,1.4)</volume>
        <offset>(0,0,-0.05)</offset>
      </shadowData>
    </graphicData>
    <techLevel>Industrial</techLevel>
    <uiIconPath>NewThings/Security/TurretMinigun/TurretMinigun_MenuIcon</uiIconPath>
    <uiIconScale>0.95</uiIconScale>
    <minifiedDef>MinifiedThing</minifiedDef>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>false</rotatable>
    <size>(2,2)</size>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <MaxHitPoints>350</MaxHitPoints>
      <Flammability>0.7</Flammability>
      <WorkToBuild>15000</WorkToBuild>
      <Mass>140</Mass>
      <Beauty>-20</Beauty>
      <ShootingAccuracyTurret>0.96</ShootingAccuracyTurret> <!-- like level 8 human shooter -->
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Explosive">
        <explosiveRadius>5.9</explosiveRadius>
        <explosiveDamageType>Bomb</explosiveDamageType>
        <chanceNeverExplodeFromDamage>0.5</chanceNeverExplodeFromDamage>
      </li>
      <li Class="CompProperties_Forbiddable" />
      <li Class="CompProperties_Power">
        <compClass>CompPowerTrader</compClass>
        <basePowerConsumption>160</basePowerConsumption>
      </li>
      <li Class="CompProperties_Flickable" />
      <li Class="CompProperties_Breakdownable" />
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Shots until barrel change</fuelLabel>
        <fuelGizmoLabel>Barrel durability</fuelGizmoLabel>
        <fuelFilter>
          <thingDefs>
            <li>Steel</li>
          </thingDefs>
        </fuelFilter>
        <fuelCapacity>180</fuelCapacity>
        <initialFuelPercent>1</initialFuelPercent>
        <autoRefuelPercent>0.5</autoRefuelPercent>
        <showFuelGizmo>true</showFuelGizmo>
        <minimumFueledThreshold>1</minimumFueledThreshold>
        <fuelMultiplier>1</fuelMultiplier>
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <outOfFuelMessage>Needs new barrel</outOfFuelMessage>
        <fuelIconPath>UI/Overlays/Barrel</fuelIconPath>
      </li>
      <li Class="CompProperties_Stunnable">
        <affectedDamageDefs>
          <li>Stun</li>
          <li>EMP</li>
        </affectedDamageDefs>
      </li>
    </comps>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.5</fillPercent>
    <hasTooltip>true</hasTooltip>
    <costList>
      <Steel>350</Steel>
      <Plasteel>30</Plasteel>
      <ComponentIndustrial>6</ComponentIndustrial>
    </costList>
    <terrainAffordanceNeeded>Heavy</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <building>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>VFES_TurretMinigun_Top</turretGunDef>
      <turretBurstCooldownTime>5</turretBurstCooldownTime>
      <turretTopDrawSize>2.7</turretTopDrawSize>
      <turretTopOffset>(0, 0.05)</turretTopOffset>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
      <li>PlaceWorker_ShowTurretRadius</li>
    </placeWorkers>
    <constructionSkillPrerequisite>6</constructionSkillPrerequisite>
    <researchPrerequisites>
      <li>MultibarrelWeapons</li>
    </researchPrerequisites>
  </ThingDef>

  <ThingDef ParentName="BaseWeaponTurret">
    <defName>VFES_TurretMinigun_Top</defName>
    <label>minigun</label>
    <description>A self-loading minigun designed to be attached to a turret.</description>
    <graphicData>
      <texPath>NewThings/Security/TurretMinigun/TurretMinigun_Top</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <soundInteract>Interact_Rifle</soundInteract>
    <statBases>
      <AccuracyTouch>0.5</AccuracyTouch>
      <AccuracyShort>0.6</AccuracyShort>
      <AccuracyMedium>0.5</AccuracyMedium>
      <AccuracyLong>0.35</AccuracyLong>
      <RangedWeapon_Cooldown>5</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>80</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>Bullet_LMG</defaultProjectile>
        <warmupTime>0</warmupTime>
        <range>30.9</range>
        <ticksBetweenBurstShots>7</ticksBetweenBurstShots>
        <burstShotCount>12</burstShotCount>
        <soundCast>Shot_Minigun</soundCast>
        <soundCastTail>GunTail_Medium</soundCastTail>
        <muzzleFlashScale>12</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <!-- Charge Turret -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Turret_ChargeTurret</defName>
    <label>charge turret</label>
    <description>A portable automatic charged-shot turret. Pulse-charge technology charges each shot with unstable energy as it leaves the barrel. Requires plasteel to refurbish its barrel after heavy use. May explode when damaged. Its dumb AI brain can't be directly controlled, so beware of friendly fire.</description>
    <thingClass>Building_TurretGun</thingClass>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <graphicData>
      <texPath>NewThings/Security/TurretSpacer_Base</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(3,3)</drawSize>
      <damageData>
        <rect>(0.2,0.2,0.6,0.6)</rect>
      </damageData>
      <shadowData>
        <volume>(0.27,0.25,0.27)</volume>
        <offset>(0,0,0)</offset>
      </shadowData>
    </graphicData>
    <techLevel>Spacer</techLevel>
    <uiIconPath>NewThings/Security/ChargeTurret/ChargeTurret_MenuIcon</uiIconPath>
    <uiIconScale>0.9</uiIconScale>
    <minifiedDef>MinifiedThing</minifiedDef>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>false</rotatable>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <MaxHitPoints>200</MaxHitPoints>
      <Flammability>0.5</Flammability>
      <WorkToBuild>4000</WorkToBuild>
      <Mass>12.5</Mass>
      <Beauty>-20</Beauty>
      <ShootingAccuracyTurret>0.96</ShootingAccuracyTurret> <!-- like level 8 human shooter -->
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Explosive">
        <explosiveRadius>3.9</explosiveRadius>
        <explosiveDamageType>Bomb</explosiveDamageType>
        <chanceNeverExplodeFromDamage>0.5</chanceNeverExplodeFromDamage>
      </li>
      <li Class="CompProperties_Forbiddable"/>
      <li Class="CompProperties_Power">
        <compClass>CompPowerTrader</compClass>
        <basePowerConsumption>125</basePowerConsumption>
      </li>
      <li Class="CompProperties_Flickable"/>
      <li Class="CompProperties_Breakdownable"/>
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Shots until barrel change</fuelLabel>
        <fuelGizmoLabel>Barrel durability</fuelGizmoLabel>
        <fuelFilter><thingDefs><li>Plasteel</li></thingDefs></fuelFilter>
        <fuelCapacity>40</fuelCapacity>
        <initialFuelPercent>1</initialFuelPercent>
        <autoRefuelPercent>0.5</autoRefuelPercent>
        <showFuelGizmo>true</showFuelGizmo>
        <minimumFueledThreshold>1</minimumFueledThreshold>
        <fuelMultiplier>1</fuelMultiplier>
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <outOfFuelMessage>Needs new barrel</outOfFuelMessage>
        <fuelIconPath>UI/Overlays/PlasteelBarrel</fuelIconPath>
      </li>
      <li Class="CompProperties_Stunnable">
        <affectedDamageDefs>
          <li>Stun</li>
          <li>EMP</li>
        </affectedDamageDefs>
      </li>
    </comps>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.4</fillPercent>
    <hasTooltip>true</hasTooltip>
    <stuffCategories>
      <li>Metallic</li>
    </stuffCategories>
    <costStuffCount>30</costStuffCount>
    <costList>
      <Plasteel>40</Plasteel>
      <ComponentSpacer>1</ComponentSpacer>
    </costList>
    <designationCategory>Security</designationCategory>
    <building>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>VFES_Gun_ChargeTurret</turretGunDef>
      <turretBurstCooldownTime>3</turretBurstCooldownTime>
      <turretTopDrawSize>1.5</turretTopDrawSize>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
      <li>PlaceWorker_ShowTurretRadius</li>
    </placeWorkers>
    <constructionSkillPrerequisite>6</constructionSkillPrerequisite>
    <researchPrerequisites>
      <li>ChargedShot</li>
    </researchPrerequisites>
  </ThingDef>

  <ThingDef ParentName="BaseWeaponTurret">
    <defName>VFES_Gun_ChargeTurret</defName>
    <label>charged turret gun</label>
    <description>A charge rifle made to be mounted on a turret.</description>
    <graphicData>
      <texPath>NewThings/Security/ChargeTurret/TurretCharge_Top</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <soundInteract>Interact_Rifle</soundInteract>
    <destroyOnDrop>true</destroyOnDrop>
    <tradeability>None</tradeability>
    <useHitPoints>false</useHitPoints>
    <statBases>
      <AccuracyTouch>0.8</AccuracyTouch>
      <AccuracyShort>0.75</AccuracyShort>
      <AccuracyMedium>0.55</AccuracyMedium>
      <AccuracyLong>0.45</AccuracyLong>
      <RangedWeapon_Cooldown>3</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>4.6</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <weaponTags Inherit="false">
      <li>TurretGun</li>
    </weaponTags>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>VFES_Bullet_ChargeTurretShot</defaultProjectile>
        <range>24.9</range>
        <ticksBetweenBurstShots>10</ticksBetweenBurstShots>
        <burstShotCount>4</burstShotCount>
        <soundCast>Shot_ChargeRifle</soundCast>
        <soundCastTail>GunTail_Medium</soundCastTail>
        <muzzleFlashScale>9</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <ThingDef ParentName="BaseBullet">
    <defName>VFES_Bullet_ChargeTurretShot</defName>
    <label>charge shot</label>
    <graphicData>
      <texPath>Things/Projectile/Charge_Small</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <projectile>
      <damageDef>Bullet</damageDef>
      <damageAmountBase>14</damageAmountBase>
      <armorPenetrationBase>0.35</armorPenetrationBase>
      <speed>70</speed>
    </projectile>
  </ThingDef>

  <!-- Charge Railgun -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Turret_ChargeRailgun</defName>
    <label>charge railgun</label>
    <description>A cutting-edge, pulse-charged, rail-assisted weapon system that fires a short burst of high-velocity projectiles, energized with unstable plasma as they leave the rail. The resulting shots pierce armor and bodies alike, but the turret requires new plasteel barrel after use. It cannot fire at close range, and may explode when damaged.</description>
    <thingClass>Building_TurretGun</thingClass>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <graphicData>
      <texPath>NewThings/Security/TurretRailgun_Base</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(2,2)</drawSize>
      <damageData>
        <rect>(0.2,0.2,0.6,0.6)</rect>
      </damageData>
      <shadowData>
        <volume>(0.27,0.25,0.27)</volume>
        <offset>(0,0,0)</offset>
      </shadowData>
    </graphicData>
    <size>(2,2)</size>
    <techLevel>Spacer</techLevel>
    <uiIconPath>NewThings/Security/TurretChargeRailgun/TurretChargeRailgun_MenuIcon</uiIconPath>
    <uiIconScale>0.9</uiIconScale>
    <minifiedDef>MinifiedThing</minifiedDef>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>false</rotatable>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <MaxHitPoints>460</MaxHitPoints>
      <Flammability>0.7</Flammability>
      <WorkToBuild>24000</WorkToBuild>
      <Mass>12.5</Mass>
      <Beauty>-20</Beauty>
      <ShootingAccuracyTurret>0.96</ShootingAccuracyTurret> <!-- like level 8 human shooter -->
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Explosive">
        <explosiveRadius>3.9</explosiveRadius>
        <explosiveDamageType>Bomb</explosiveDamageType>
        <chanceNeverExplodeFromDamage>0.5</chanceNeverExplodeFromDamage>
      </li>
      <li Class="CompProperties_Forbiddable"/>
      <li Class="CompProperties_Power">
        <compClass>CompPowerTrader</compClass>
        <basePowerConsumption>125</basePowerConsumption>
      </li>
      <li Class="CompProperties_Flickable"/>
      <li Class="CompProperties_Breakdownable"/>
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Shots until barrel change</fuelLabel>
        <fuelGizmoLabel>Barrel durability</fuelGizmoLabel>
        <fuelFilter><thingDefs><li>Plasteel</li></thingDefs></fuelFilter>
        <fuelCapacity>30</fuelCapacity>
        <initialFuelPercent>1</initialFuelPercent>
        <autoRefuelPercent>0.5</autoRefuelPercent>
        <showFuelGizmo>true</showFuelGizmo>
        <minimumFueledThreshold>1</minimumFueledThreshold>
        <fuelMultiplier>0.5</fuelMultiplier> <!-- 2 plasteel per burst, 60 per full rearm -->
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <outOfFuelMessage>Needs new barrel</outOfFuelMessage>
        <fuelIconPath>UI/Overlays/PlasteelBarrel</fuelIconPath>
      </li>
      <li Class="CompProperties_Stunnable">
        <affectedDamageDefs>
          <li>Stun</li>
          <li>EMP</li>
        </affectedDamageDefs>
      </li>
    </comps>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.4</fillPercent>
    <hasTooltip>true</hasTooltip>
    <costList>
      <Plasteel>180</Plasteel>
      <Steel>100</Steel>
      <ComponentSpacer>6</ComponentSpacer>
    </costList>
    <designationCategory>Security</designationCategory>
    <building>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>VFES_Gun_RailgunTurret</turretGunDef>
      <turretBurstCooldownTime>5.333</turretBurstCooldownTime>
      <turretTopDrawSize>2.7</turretTopDrawSize>
      <turretTopOffset>(0, 0.1)</turretTopOffset>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
      <li>PlaceWorker_ShowTurretRadius</li>
    </placeWorkers>
    <constructionSkillPrerequisite>8</constructionSkillPrerequisite>
    <researchPrerequisites>
      <li>VFES_Railgun</li>
    </researchPrerequisites>
  </ThingDef>

  <ThingDef ParentName="BaseWeaponTurret">
    <defName>VFES_Gun_RailgunTurret</defName>
    <label>charged turret gun</label>
    <description>An advanced railgun designed to launch electromagnetically accelerated projectiles.</description>
    <graphicData>
      <texPath>NewThings/Security/TurretChargeRailgun/TurretChargeRailgun_Top</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <soundInteract>Interact_Rifle</soundInteract>
    <destroyOnDrop>true</destroyOnDrop>
    <tradeability>None</tradeability>
    <useHitPoints>false</useHitPoints>
    <statBases>
      <AccuracyTouch>0.22</AccuracyTouch>
      <AccuracyShort>0.36</AccuracyShort>
      <AccuracyMedium>0.68</AccuracyMedium>
      <AccuracyLong>0.92</AccuracyLong>
      <RangedWeapon_Cooldown>5.333</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>4.6</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <weaponTags Inherit="false">
      <li>TurretGun</li>
    </weaponTags>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>VFES_Bullet_ChargeRailgunShot</defaultProjectile>
        <range>45.9</range>
        <ticksBetweenBurstShots>38</ticksBetweenBurstShots>
        <burstShotCount>3</burstShotCount>
        <soundCast>ChargeLance_Fire</soundCast>
        <soundCastTail>GunTail_Heavy</soundCastTail>
        <muzzleFlashScale>9</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <ThingDef ParentName="BaseBullet">
    <defName>VFES_Bullet_ChargeRailgunShot</defName>
    <label>charge railgun shot</label>
    <graphicData>
      <texPath>Things/Projectile/ChargeLanceShot</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <shaderType>TransparentPostLight</shaderType>
      <drawSize>1.5</drawSize>
    </graphicData>
    <projectile>
      <!-- More damage than charge lance, other stats are identical. -->
      <damageDef>Bullet</damageDef>
      <damageAmountBase>50</damageAmountBase>
      <armorPenetrationBase>0.45</armorPenetrationBase>
      <speed>120</speed>
      <stoppingPower>1.5</stoppingPower>
    </projectile>
  </ThingDef>

  <!-- Tesla blaster -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Turret_TeslaBlaster</defName>
    <label>tesla blaster</label>
    <description>A cutting-edge utility turret designed to counter mechanoid advances. Four capacitors are charged to release a bolt of electricity that is carefully modulated by the internal targeting system before release. Upon impact, the power surge affects the unit's power module and siphons off any reserves before seeking to jump to a nearby machine, gradually weakening. This can occur twice before the initially modulated current becomes too similar to hosts, upon which safety overrides ground the excess power. Will only target mechanoids.</description>
    <thingClass>Building_TurretGun</thingClass>
    <techLevel>Spacer</techLevel>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <graphicData>
      <texPath>NewThings/Security/TurretRailgun_Base</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(2,2)</drawSize>
      <damageData>
        <rect>(0.2,0.2,0.6,0.6)</rect>
      </damageData>
      <shadowData>
        <volume>(0.27,0.25,0.27)</volume>
        <offset>(0,0,0)</offset>
      </shadowData>
    </graphicData>
    <uiIconPath>NewThings/Security/TurretTeslaBlaster/TurretTeslaBlaster_MenuIcon</uiIconPath>
    <uiIconScale>0.90</uiIconScale>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>false</rotatable>
    <size>(2,2)</size>
    <statBases>
      <MaxHitPoints>500</MaxHitPoints>
      <Flammability>0.7</Flammability>
      <WorkToBuild>20000</WorkToBuild>
      <Mass>8</Mass>
      <Beauty>-20</Beauty>
      <ShootingAccuracyTurret>0.96</ShootingAccuracyTurret> <!-- like level 8 human shooter -->
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Explosive">
        <wickTicks>240</wickTicks>
        <explosiveRadius>5.9</explosiveRadius>
        <explosiveDamageType>EMP</explosiveDamageType>
        <chanceNeverExplodeFromDamage>0.5</chanceNeverExplodeFromDamage>
        <startWickHitPointsPercent>0.2</startWickHitPointsPercent>
      </li>
      <li Class="CompProperties_Forbiddable" />
      <li Class="CompProperties_Power">
        <compClass>CompPowerTrader</compClass>
        <basePowerConsumption>400</basePowerConsumption>
      </li>
      <li Class="CompProperties_Flickable" />
      <li Class="CompProperties_Breakdownable" />
    </comps>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.4</fillPercent>
    <hasTooltip>true</hasTooltip>
    <costList>
      <Plasteel>120</Plasteel>
      <Steel>60</Steel>
      <ComponentSpacer>8</ComponentSpacer>
    </costList>
    <terrainAffordanceNeeded>Heavy</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <constructionSkillPrerequisite>8</constructionSkillPrerequisite>
    <building>
      <combatPower>45</combatPower>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>Gun_TeslaBlaster</turretGunDef>
      <turretBurstCooldownTime>5.0</turretBurstCooldownTime>
      <turretTopDrawSize>3</turretTopDrawSize>
      <turretTopOffset>(0, 0.1)</turretTopOffset>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
      <li>PlaceWorker_ShowTurretRadius</li>
    </placeWorkers>
    <designationHotKey>Misc2</designationHotKey>
    <researchPrerequisites>
      <li>VFES_EMPCannon</li>
    </researchPrerequisites>
  </ThingDef>

  <ThingDef ParentName="BaseBullet">
    <defName>Bullet_TeslaBlaster</defName>
    <label>tesla blaster bolt</label>
    <thingClass>VEF.Weapons.TeslaProjectile</thingClass>
    <graphicData>
      <texPath>Projectile/Lightning</texPath>
      <graphicClass>Graphic_Flicker</graphicClass>
    </graphicData>
    <projectile>
      <damageDef>Smoke</damageDef>
      <damageAmountBase>10</damageAmountBase>
      <speed>150</speed>
      <armorPenetrationBase>0</armorPenetrationBase>
    </projectile>
    <modExtensions>
      <li Class="VEF.Weapons.TeslaChainingProps">
        <addFire>false</addFire>
        <bounceRange>6</bounceRange>
        <maxBounceCount>3</maxBounceCount>
        <damageDef>EMP</damageDef>
        <targetFriendly>false</targetFriendly>
        <maxLifetime>60</maxLifetime>
      </li>
    </modExtensions>
  </ThingDef>

  <ThingDef ParentName="BaseWeaponTurret">
    <defName>Gun_TeslaBlaster</defName>
    <label>tesla blaster</label>
    <description>A specialized electrical weapon designed to be mounted on a turret.</description>
    <graphicData>
      <texPath>NewThings/Security/TurretTeslaBlaster/TurretTeslaBlaster_Top</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <statBases>
      <AccuracyTouch>1.0</AccuracyTouch>
      <AccuracyShort>1.0</AccuracyShort>
      <AccuracyMedium>1.0</AccuracyMedium>
      <AccuracyLong>1.0</AccuracyLong>
      <RangedWeapon_Cooldown>5.0</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>5</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <defaultProjectile>Bullet_TeslaBlaster</defaultProjectile>
        <warmupTime>4.0</warmupTime>
        <range>32.9</range>
        <minRange>9.9</minRange>
        <burstShotCount>1</burstShotCount>
        <soundCast>GunShotA</soundCast>
        <soundCastTail>GunTail_Light</soundCastTail>
        <muzzleFlashScale>9</muzzleFlashScale>
      </li>
    </verbs>
  </ThingDef>

  <!-- Charge complex -->
  <ThingDef ParentName="BuildingBase">
    <defName>VFES_Complex_Charge</defName>
    <label>charge complex</label>
    <description>A heavy, pulse-charged rapid-fire blaster mounted on a barricade to grant cover. Needs to be manned in order to fire. Requires plasteel to refurbish its barrel after heavy use.</description>
    <thingClass>Building_TurretGun</thingClass>
    <drawerType>MapMeshAndRealTime</drawerType>
    <drawHighlight>true</drawHighlight>
    <drawHighlightOnlyForHostile>true</drawHighlightOnlyForHostile>
    <graphicData>
      <texPath>Things/Building/Linked/Barricade_Atlas</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <linkType>Basic</linkType>
      <linkFlags>
        <li>Barricades</li>
      </linkFlags>
      <color>(139,122,87)</color>
    </graphicData>
    <techLevel>Spacer</techLevel>
    <uiIconPath>NewThings/Security/ComplexChargeBlasterTurret/ComplexChargeBlasterTurret_MenuIcon</uiIconPath>
    <uiIconScale>0.95</uiIconScale>
    <minifiedDef>MinifiedThing</minifiedDef>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>true</rotatable>
    <size>(1,1)</size>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <MaxHitPoints>300</MaxHitPoints>
      <Flammability>0.0</Flammability>
      <WorkToBuild>36000</WorkToBuild>
      <Mass>300</Mass>
      <Beauty>-6</Beauty>
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Forbiddable" />
      <li Class="CompProperties_Mannable">
        <manWorkType>Violent</manWorkType>
        <planetLayerWhitelist>
          <li>Surface</li>
        </planetLayerWhitelist>
      </li>
      <li Class="CompProperties_Breakdownable" />
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Shots until barrel change</fuelLabel>
        <fuelGizmoLabel>Barrel durability</fuelGizmoLabel>
        <fuelFilter><thingDefs><li>Plasteel</li></thingDefs></fuelFilter>
        <fuelCapacity>120</fuelCapacity>
        <initialFuelPercent>1</initialFuelPercent>
        <autoRefuelPercent>0.5</autoRefuelPercent>
        <showFuelGizmo>true</showFuelGizmo>
        <minimumFueledThreshold>1</minimumFueledThreshold>
        <fuelMultiplier>2</fuelMultiplier> <!-- 0.5 plasteel per burst, 60 per full rearm -->
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <outOfFuelMessage>Needs new barrel</outOfFuelMessage>
        <fuelIconPath>UI/Overlays/PlasteelBarrel</fuelIconPath>
      </li>
    </comps>
    <interactionCellOffset>(0,0,-1)</interactionCellOffset>
    <hasInteractionCell>true</hasInteractionCell>
    <passability>PassThroughOnly</passability>
    <pathCost>42</pathCost>
    <fillPercent>0.55</fillPercent>
    <hasTooltip>true</hasTooltip>
    <stuffCategories>
      <li>Metallic</li>
      <li>Woody</li>
      <li>Stony</li>
    </stuffCategories>
    <costStuffCount>5</costStuffCount>
    <costList>
      <Plasteel>70</Plasteel>
      <ComponentSpacer>3</ComponentSpacer>
    </costList>
    <terrainAffordanceNeeded>Light</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <building>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>VFES_ComplexCharge_Top</turretGunDef>
      <turretBurstCooldownTime>3.7</turretBurstCooldownTime>
      <turretTopOffset>(0, 0.05)</turretTopOffset>
      <blueprintGraphicData>
        <texPath>Things/Building/Linked/Barricade_Blueprint_Atlas</texPath>
      </blueprintGraphicData>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
      <li>PlaceWorker_ShowTurretRadius</li>
    </placeWorkers>
    <constructionSkillPrerequisite>7</constructionSkillPrerequisite>
    <researchPrerequisites>
      <li>ChargedShot</li>
    </researchPrerequisites>
    <modExtensions>
      <li Class="VEF.Weapons.AutoRefuelMannedTurrets">
        <reloadsMoreThanSingleItem>true</reloadsMoreThanSingleItem>
      </li>
    </modExtensions>
  </ThingDef>

  <ThingDef ParentName="BaseWeaponTurret">
    <defName>VFES_ComplexCharge_Top</defName>
    <label>minigun</label>
    <description>A self-loading minigun designed to be attached to a turret.</description>
    <graphicData>
      <texPath>NewThings/Security/ComplexChargeBlasterTurret/ComplexChargeBlasterTurret_Top</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <soundInteract>Interact_Rifle</soundInteract>
    <statBases>
      <AccuracyTouch>0.26</AccuracyTouch>
      <AccuracyShort>0.32</AccuracyShort>
      <AccuracyMedium>0.32</AccuracyMedium>
      <AccuracyLong>0.26</AccuracyLong>
      <RangedWeapon_Cooldown>3.7</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>80</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>VFES_Bullet_ChargeComplex</defaultProjectile>
        <warmupTime>1.25</warmupTime>
        <range>29.9</range>
        <ticksBetweenBurstShots>5</ticksBetweenBurstShots>
        <burstShotCount>12</burstShotCount>
        <soundCast>Shot_ChargeBlaster</soundCast>
        <soundCastTail>GunTail_Medium</soundCastTail>
        <muzzleFlashScale>11</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <ThingDef ParentName="BaseBullet">
    <defName>VFES_Bullet_ChargeComplex</defName>
    <label>charge shot</label>
    <graphicData>
      <texPath>Things/Projectile/Bullet_Charge_Big</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <projectile>
      <damageDef>Bullet</damageDef>
      <damageAmountBase>15</damageAmountBase>
      <armorPenetrationBase>0.22</armorPenetrationBase>
      <speed>90</speed>
    </projectile>
  </ThingDef>

</Defs>